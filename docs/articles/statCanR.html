<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>statCanR • statcanR</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="statCanR">
<meta property="og:description" content="statcanR">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">statcanR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/statCanR.html">statCanR</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/warint/statcanR/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="statCanR_files/accessible-code-block-0.0.1/empty-anchor.js"></script><link href="statCanR_files/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet">
<script src="statCanR_files/anchor-sections-1.0.1/anchor-sections.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>statCanR</h1>
                        <h4 class="author">Thierry Warin</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/warint/statcanR/blob/master/vignettes/statCanR.Rmd"><code>vignettes/statCanR.Rmd</code></a></small>
      <div class="hidden name"><code>statCanR.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://github.com/warint/statcanR">statcanR</a></span><span class="op">)</span></code></pre></div>
<div id="overview" class="section level2">
<h2 class="hasAnchor">
<a href="#overview" class="anchor"></a>Overview</h2>
<p>statcanR provides the R user with a consistent process to collect data from Statistics Canada’s data portal. It provides access to all Statistics Canada’ open economic data (formerly known as CANSIM tables) now identified by product IDs (PID) by the new Statistics Canada’s Web Data Service: <a href="https://www150.statcan.gc.ca/n1/en/type/data" class="uri">https://www150.statcan.gc.ca/n1/en/type/data</a>.</p>
</div>
<div id="quick-start" class="section level2">
<h2 class="hasAnchor">
<a href="#quick-start" class="anchor"></a>Quick start</h2>
<p>First, install statcanR:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://devtools.r-lib.org//reference/remote-reexports.html">install_github</a></span><span class="op">(</span><span class="st">"warint/statcanR"</span><span class="op">)</span></code></pre></div>
<p>Next, call statcanR to make sure everything is installed correctly.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://github.com/warint/statcanR">statcanR</a></span><span class="op">)</span></code></pre></div>
</div>
<div id="practical-usage" class="section level1">
<h1 class="hasAnchor">
<a href="#practical-usage" class="anchor"></a>Practical usage</h1>
<p>This section presents an example of how to use the statcanR R package and its function statcan_data().</p>
<p>The following example is provided to illustrate how to use the function. It consists in collecting some descriptive statistics about the Canadian labour force at the federal, provincial and industrial levels, on a monthly basis.</p>
<p>With a simple web search ‘statistics canada wages by industry metropolitan area monthly’, the table number can easily be found on Statisitcs Canada’s webpage. Here is below a figure that illustrates this example, such as ‘27-10-0014-01’ for the Federal expenditures on science and technology, by socio-economic objectives.</p>
<p>Once the table number is identified, the statcan_data() function is easy to use in order to collect the data, as following:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Get data with statcan_data function</span>
<span class="va">mydata</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/statcan_data.html">statcan_data</a></span><span class="op">(</span><span class="st">"27-10-0014-01"</span>, <span class="st">"eng"</span><span class="op">)</span>
<span class="co"># sqs_statcandata will be depricated </span>
<span class="va">mydata</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/statcanR-deprecated.html">sqs_statcan_data</a></span><span class="op">(</span><span class="st">"27-10-0014-01"</span>,<span class="st">"eng"</span><span class="op">)</span></code></pre></div>
<p>Should you want the same data in French, just replace the argument at the end of the function with “fra”.</p>
<div id="code-architecture" class="section level2">
<h2 class="hasAnchor">
<a href="#code-architecture" class="anchor"></a>Code architecture</h2>
<p>This section describes the code architecture of the statcanR package.</p>
<p>In details, the statcan_data() function has 2 arguments:</p>
<ol style="list-style-type: decimal">
<li>tableNumber</li>
<li>lang</li>
</ol>
<p>The ‘tableNumber’ argument simply refers to the table number of the Statistics Canada data table a user wants to collect, such as ‘27-10-0014-01’ for the Federal expenditures on science and technology, by socio-economic objectives, as an example.</p>
<p>The second argument, ‘lang’, refers to the language. As Canada is a bilingual country, Statistics Canada displays all the economic data in both languages. Therefore, users can choose to collect satistics data tables in French or English by setting the lang argument with c(“fra”, “eng”).</p>
<p>The code architecture of the statcan_data() function is as follows. The first step if to clean the table number in order to align it with the official typology of Statistics Canada’s Web Data Service. The second step is to create a temporary folder where all the data wrangling operations are performed. The third step is to check and select the correct language. The fourth step is to define the right URL where the actual data table is stored and then to download the .Zip container. The fifth step is to unzip the previously downloaded .Zip file to extract the data and metadata from the .csv files. The final step is to load the statistics data into a data frame called ‘sqs_data’ and to add the official table indicator name in the new ‘INDICATOR’ column.</p>
<p>To be more precise about the statcan_data() function, here is below some further code description:</p>
<ul>
<li><p><code>tableNumber &lt;- gsub("-", "", substr(tableNumber, 1, nchar(tableNumber)-2))</code>: The first step is to clean the table number provided by the user in order to collect the overall data table related to the specific indicator the user is interested in. In fact, each indicator is an excerpt of the overall table. In addition, following the new Statistics Canada’s Web Data Service, the URL typology defined by REST API is stored in csv files by table numbers without a ‘-’. Also, the last 2 digits after the last ‘-’ refer to the specific excerpt of the original table. Therefore, following the Statistics Canada Web Data Service’s typology, the function first removes the ‘-’ and the last 2 digits from the user’s selection.</p></li>
<li><p><code>if(lang == "eng")</code> | <code>if(lang == "fra")</code>: The second step is the ‘if statement’ to get the data in the correct language.</p></li>
<li><p><code>urlFra &lt;- paste0("https://www150.statcan.gc.ca/n1/fr/tbl/csv/", tableNumber, "-fra.zip")</code>: The third step is to create the correct url in order to download the respective .Zip file from the Statistics Canada Web Data Service.</p></li>
<li><p><code>download(urlFra, download_dir, mode = "wb")</code>: The fourth step is a simple downloading function that extracts .Zip file and download it into a temporary folder.</p></li>
<li><p><code><a href="https://rdrr.io/r/utils/unzip.html">unzip(zipfile = download_dir, exdir = unzip_dir)</a></code>: The fifth step consists in unzipping the .Zip file. The unzipping process gives access to two diffrent .csv files, such as the overall data table and the metadata table.</p></li>
<li><p><code><a href="https://Rdatatable.gitlab.io/data.table/reference/fread.html">data.table::fread(csv_file)</a></code>: The sixth step consists in loading the data table into a unique data frame. The fread() function from the data.table package is used for its higher performance.</p></li>
<li><p><code>data$INDICATOR &lt;- as.character(0)</code> and <code>data$INDICATOR &lt;- as.character(read.csv(paste0(path,"/temp/", tableNumber, "_MetaData.csv"))[1,1])</code>: The seventh step of the sqs_statcan_data() function consists in adding the name of the table from the metadata table.</p></li>
<li><p><code><a href="https://rdrr.io/r/base/unlink.html">unlink(tempdir())</a></code>: The eighth step deletes the temporary folder used to download, unzip, extract and load the data.</p></li>
<li><p><code><a href="https://rdrr.io/r/base/function.html">return(Data)</a></code>: Finally, the last step of the statcan_data() function allows to return the value into the user’s environment.</p></li>
</ul>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Thierry Warin, Romain Le Duc.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.9000.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
